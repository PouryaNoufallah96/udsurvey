import{d as R,E as V,T as L,H as S,h as j,r as z,Z as P,o as d,i as l,b as A,w as J,u as n,a as s,t as c,n as g,F as h,z as b,A as k,I as M,B as Y,p as B,q as Z,_ as G,f as K}from"./entry.87f1605d.js";import{u as U}from"./asyncData.f0c46025.js";import{C as W}from"./common.0bb1eeb8.js";import{T as X}from"./handle-toast.69ee9aaa.js";const q={key:0,class:"flex flex-col gap-10"},ee={class:"flex justify-between"},se={class:"flex flex-col gap-2"},te={class:"text-lg font-bold text-primary"},oe={class:"text-sm font-bold"},ae={class:"text-sm font-bold"},re=s("i",{class:"pi pi-calendar-times text-danger"},null,-1),ne={class:"p-4 flex flex-col gap-8 bg-white rounded-md shadow-md"},ue={class:"flex gap-3 items-center"},de={class:"text-primary font-extrabold text-3xl"},le=g(),ie={class:"text-base font-semibold"},ce={class:"flex flex-col gap-8 md:gap-4"},pe={class:"text-sm font-semibold"},me={class:"flex items-center gap-1 md:gap-3"},_e=["onClick"],fe=["onInput"],Ie=R({__name:"[id]",async setup(ye){var C;let f,w;const{handlingError:T,customClientErrorHandler:Q}=V(),v=X(),{gregorianToJalali:E}=W(),F=L().params.id,{data:i,error:y}=([f,w]=S(async()=>U("get-survey-by-user-by-id",async()=>{var e=await B(`/survey/get-survey-by-id/${F}`);return e.result},{initialCache:!1},"$gOdy71FR7a")),f=await f,w(),f);y.value&&T(y.value,(e,t)=>v.error(e,t)),j({title:`\u0646\u0638\u0631\u0633\u0646\u062C\u06CC | ${(C=i.value)==null?void 0:C.title}`});const x=z(!1),r=P([]),H=5,N=(e,t,o)=>{if(I(e,t)){const a=r.findIndex(_=>_.surveyItemId==t&&_.surveyQuestionId==e);if(r[a].point==o)return r.splice(a,1);r.splice(a,1)}const u={surveyQuestionId:e,surveyItemId:t,point:o,description:""};r.push(u)},I=(e,t)=>r.some(o=>o.surveyItemId==t&&o.surveyQuestionId==e),$=(e,t,o)=>r.some(u=>u.surveyItemId==t&&u.surveyQuestionId==e&&u.point==o),D=(e,t,o)=>{var u=o.target.value;r.find(a=>a.surveyItemId==t&&a.surveyQuestionId==e).description=u},O=async()=>{try{x.value=!0;const e={surveyId:i.value.id,results:r};await B("survey/add-survey-result",{method:"POST",body:e}),v.success("\u0628\u0627 \u062A\u0634\u06A9\u0631","\u0646\u0638\u0631\u0627\u062A \u0634\u0645\u0627 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062B\u0628\u062A \u0634\u062F"),setTimeout(()=>{Z("/")},2e3)}catch(e){x.value=!1,Q(e,(t,o)=>v.error(t,o))}};return(e,t)=>{const o=G,u=K;return d(),l("div",null,[A(u,{name:"dashboard"},{default:J(()=>[n(y)?(d(),l(h,{key:1},[g(c(n(y).message),1)],64)):(d(),l("div",q,[s("div",ee,[s("div",se,[s("h1",te,c(n(i).title),1),s("h2",oe,c(n(i).surveyCategory),1)]),s("span",ae,[g(c(n(E)(n(i).deadLine))+" ",1),re])]),s("div",ne,[(d(!0),l(h,null,b(n(i).surveyQuestions,(a,_)=>(d(),l("div",{key:a.id,class:k(["flex flex-col gap-6",{"pb-8 border-b-[1px]  border-disabled":_!=n(i).surveyQuestions.length-1}])},[s("p",ue,[s("span",de,c(_+1),1),le,s("span",ie,c(a.title),1)]),s("div",ce,[(d(!0),l(h,null,b(n(i).surveyItems,p=>(d(),l("div",{key:p.id,class:"mx-6 flex flex-col gap-6 md:flex-row md:items-center md:gap-10 flex-wrap"},[s("p",pe,c(p.title),1),s("div",me,[(d(),l(h,null,b(H,m=>s("button",{type:"button",key:m,onClick:ve=>N(a.id,p.id,m),class:k(["flex justify-center items-center select-none cursor-pointer border-2 text-xl font-bold p-2 rounded-full shadow h-10 w-10 hover:shadow-md hover:bg-primary-light",$(a.id,p.id,m)?"bg-primary text-light shadow-md outline-none shadow-outline":"bg-white"])},[s("span",null,c(m),1)],10,_e)),64))]),I(a.id,p.id)?(d(),l("input",{key:0,placeholder:"\u062A\u0648\u0636\u06CC\u062D\u0627\u062A",class:"p-2 rounded-md outline-none border border-1 border-light bg-white shadow text-sm grow focus:border-disabled focus:ring-0 focus:ring-offset-0",onInput:m=>D(a.id,p.id,m)},null,40,fe)):M("",!0)]))),128))])],2))),128)),A(o,{disabled:!r||!r.length||x.value,class:"mt-6 self-start px-10",onClick:O,"btn-type":n(Y).PRIMARY,text:"\u062B\u0628\u062A"},null,8,["disabled","btn-type"])])]))]),_:1})])}}});export{Ie as default};
